// Define a Sass variable for the primary color to use with Sass functions
$primary-color-value: #2a64f8;

:root {
    --primary-color: #{$primary-color-value}; // Use the Sass variable to set the CSS variable
    --bg-color: #212121;
    --ui-bg-color: #2c2c2c;
    --ui-hover-color: #383838;
    --ui-active-color: #444444;
    --border-color: #444444;
    --text-color: #ccc;
    --text-strong-color: #ffffff;
    --active-highlight-color: var(--primary-color);
    --kl-color: var(--primary-color);
    --ui-bg-dark: var(--ui-bg-color);
}

body.kl-theme-dark {
    color-scheme: dark;
    color: var(--text-color);
    background: var(--bg-color);

    .kl-toolspace {
        background: var(--ui-bg-color);
    }

    .kl-toolspace--left {
        border-right: 1px solid var(--border-color);
    }

    .kl-toolspace--right {
        border-left: 1px solid var(--border-color);
    }

    .kl-toolspace-row {
        background: none;
        box-shadow: 0 1px 1px #1a1a1a;
    }

    .toolspace-row-button-activated {
        background: var(--primary-color);
        color: var(--text-strong-color);
    }

    .toolspace-row-button-hover,
    .toolspace-row-button:hover {
        background: var(--ui-hover-color);
    }

    .toolspace-row-button:active {
        background: var(--ui-active-color);
    }

    .toolspace-svg-triangle-button-hover {
        fill: var(--ui-hover-color);
    }

    .toolspace-svg-triangle-button:active {
        fill: var(--ui-active-color);
    }

    .toolspace-row-button__submit:hover {
        background: lighten($primary-color-value, 10%);
    }

    .tabrow {
        background: none;
        border-bottom: 1px solid var(--border-color);
    }

    .tabrow__tab {
        color: var(--text-strong-color);
    }

    .tabrow__tab--opened,
    .tabrow__tab--opened-accented {
        background-color: var(--ui-bg-color);
    }
    
    .tabrow__tab--opened-accented {
        box-shadow: inset 0 2px 0 0 var(--primary-color);
    }

    .tabrow__tab div {
        filter: brightness(0.75);
    }

    .tabrow__tab:not(.tabrow__tab--opened, .tabrow__tab--opened-accented):hover {
        background-color: var(--ui-hover-color);
    }

    .tabrow__tab:active:not(.tabrow__tab--opened-accented, .tabrow__tab--opened) {
        box-shadow: inset 0 1px #999;
    }

    .tabrow__tab__rounding-left,
    .tabrow__tab__rounding-right {
        background: var(--ui-bg-color);
    }

    .kl-tool-row-border-right {
        border-right: 1px solid var(--border-color);
    }

    .tool-dropdown-wrapper {
        background-color: var(--ui-bg-color);
    }

    .tool-dropdown-button:hover {
        background: var(--ui-hover-color);
    }

    .tool-dropdown-button:active {
        background: var(--ui-active-color);
    }

    .kl-popup {
        background: rgba(0, 0, 0, 0.6);
    }

    .kl-popup-box,
    .kl-d-modal {
        background-color: var(--ui-bg-color);
        box-shadow: 0 0 0 1px var(--border-color);
    }

    .kl-d-modal-root {
        background: rgba(0, 0, 0, 0.6);
    }

    button {
        color: var(--text-color);
        background-color: #4a4a4a;
        background-image: none;
        box-shadow: none;
    }

    button:hover {
        background-color: #555;
        color: var(--text-strong-color);
    }

    button:active {
        background-color: #555;
        color: var(--text-strong-color);
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    button:disabled {
        color: #999;
        background-color: transparent;
        background-image: none;
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1);
        pointer-events: none;
    }

    .kl-button-primary {
        background: var(--primary-color);
        color: var(--text-strong-color);

        &:hover {
            background-image: none;
            background-color: lighten($primary-color-value, 10%);
        }
    }

    button:not(.kl-button-primary, .kl-button-cancel) img:not(.dark-no-invert) {
        filter: invert(1) hue-rotate(180deg);
    }

    input,
    textarea {
        background: var(--ui-bg-color);
        color: var(--text-color);
        border: 1px solid var(--border-color);
    }

    input:focus,
    textarea:focus {
        background: var(--bg-color);
        color: var(--text-strong-color);
        border-color: var(--primary-color);
    }

    .kl-select {
        background: var(--bg-color);
        color: var(--text-strong-color);
        border: 1px solid var(--border-color);
    }

    .kl-checkbox__inner {
        color: var(--text-color);
        &:hover {
            color: var(--text-strong-color);
        }
    }

    .kl-checkbox--highlight {
        background: none;
        box-shadow: 0 0 0 1px var(--primary-color);
    }

    .kl-option {
        background: var(--ui-bg-color);
        color: var(--text-color);
        box-shadow: inset 0 0 0 1px var(--border-color);

        &:not(.kl-option-selected):hover {
            background: var(--ui-hover-color);
        }

        &:not(.kl-option-selected):active {
            box-shadow: inset 0 0 0 2px var(--border-color);
        }
    }

    .kl-option-selected {
        background: var(--ui-active-color);
        color: var(--text-strong-color);
        box-shadow: inset 0 0 0 2px var(--primary-color);
    }

    .kl-box-toggle {
        color: var(--text-color);
        box-shadow: inset 0 0 0 1px var(--border-color);

        &:not(.kl-box-toggle--active) {
            &:hover {
                background: var(--ui-hover-color);
            }
            &:active {
                box-shadow: inset 0 0 0 2px var(--border-color);
            }
        }
    }

    .kl-box-toggle--active {
        color: var(--text-strong-color);
        background: var(--ui-active-color);
        box-shadow: inset 0 0 0 2px var(--primary-color);
    }

    .dark-invert {
        filter: invert(1);
    }

    .kl-file-no-autosave {
        background: transparent;
        color: #c9b184;
        box-shadow: inset 0 0 0 1px;
    }

    .slider-wrapper {
        background: #222;
        box-shadow: 0 0 0 1px var(--border-color);
        color: var(--text-color);
        text-shadow: none;

        .slider-inner {
            background: #555;
            box-shadow: 1px 0 0 var(--border-color);
        }
    }

    .slider-wrapper--active {
        box-shadow: 0 0 0 1px var(--primary-color);
        color: var(--text-strong-color);

        .slider-inner {
            box-shadow: 1px 0 0 var(--primary-color);
        }
    }

    .slider-wrapper--disabled {
        box-shadow: none;
        color: #999;
    }

    .info-hint {
        background: none;
        border: 1px solid #a66969;
        color: #f5a7a7;
    }

    .kl-2-tabs {
        .kl-2-tabs__left,
        .kl-2-tabs__right {
            border: 1px solid var(--border-color);
            color: var(--text-color);
            border-bottom: none;
            &:hover {
                background: var(--ui-hover-color);
            }
        }

        .kl-2-tabs--active {
            color: var(--text-strong-color);
            background: var(--ui-active-color);
            border: 1px solid var(--primary-color);
            border-bottom: none;
        }
    }

    .popup-x {
        filter: invert(1);
        &:hover {
            filter: invert(1) brightness(1.4);
        }
    }

    .kl-preview-wrapper {
        background: var(--bg-color);
        box-shadow:
            inset 0 1px var(--border-color),
            inset 0 -1px var(--border-color);

        .kl-preview-wrapper__canvas {
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.25);
        }
    }

    .kl-edit-crop-preview,
    .kl-transparent-preview {
        border-top: 1px solid var(--border-color);
        border-bottom: 1px solid var(--border-color);
        box-shadow: none;
    }

    .kl-transparent-preview .kl-transparent-preview__canvas {
        box-shadow: 0 0 0 1px var(--border-color);
    }

    .kl-merge-preview {
        box-shadow: 0 0 0 1px var(--border-color);
    }

    a:link,
    a:not([href]),
    a:visited {
        color: #64acff;

        &:hover {
            color: #b2e8ff;
        }
    }

    .kl-color-picker__h,
    .kl-color-picker__sv,
    .kl-color-picker__preview {
        box-shadow: 0 0 0 1px var(--border-color);
    }

    .kl-color-picker--active {
        box-shadow: 0 0 0 1px var(--primary-color);
    }

    .kl-color-picker__secondary {
        box-shadow: 0 0 0 1px #7a7a7a;
    }

    .kl-stabilizer {
        color: var(--text-color);
    }

    .brush-alpha,
    .brush-alpha--selected {
        filter: invert(1) hue-rotate(180deg);
    }

    .kl-layer-preview {
        color: var(--text-color);
        canvas {
            box-shadow: 0 0 0 1px #7a7a7a;
        }
    }

    .kl-import-note,
    .kl-toolspace-note {
        background: none;
        color: #d5d558;
        border: 1px solid #d5d558;
    }

    .kl-curves-graph {
        canvas {
            background: #dedede;
            filter: invert(1) hue-rotate(180deg);
        }
    }

    .kl-curves-graph__grip {
        background: #fff;
        box-shadow: none;
    }

    .kl-storage-preview {
        background: #212121;
        box-shadow: inset 0 0 0 1px var(--border-color);
        color: #aaa;
    }

    .kl-storage-preview__im {
        box-shadow: 0 0 0 1px var(--border-color);
    }

    .kl-info-btn {
        box-shadow: inset 0 0 0 1px var(--text-strong-color);
    }

    .kl-layer {
        background: transparent;
        border: 1px solid #4f4f4f;
        .kl-layer__label,
        .kl-layer__opacity-label {
            color: var(--text-color);
        }
    }

    .kl-layer--selected {
        background: var(--ui-hover-color);
        border: 1px solid var(--primary-color);

        .kl-layer__label {
            color: var(--text-strong-color);
        }
    }

    .kl-point-slider__line {
        background: #777;
    }

    .kl-point-slider__point {
        box-shadow: none;
    }

    .kl-overlay-toolspace {
        background: transparent;
        border: none;
        box-shadow: none;
    }

    .kl-overlay-toolspace__color {
        box-shadow: 0 0 0 1px var(--border-color);
    }

    .image-toggle {
        &:not(.image-toggle-active) {
            &:hover {
                background: var(--ui-hover-color);
            }
            &:active {
                box-shadow: #838383 0 0 0 2px;
            }
        }
    }

    .image-toggle-active {
        background: var(--ui-hover-color);
    }

    .kl-file-save-wrapper {
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    .grid-hr {
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        border-top: none;
    }

    .kl-color-option {
        box-shadow: 0 0 0 1px #7a7a7a;
        &:not(.kl-color-option--active):active {
            box-shadow: 0 0 0 2px #7a7a7a;
        }
    }

    .kl-color-option--active {
        box-shadow:
            0 0 0 2px var(--primary-color),
            0 0 5px 0 var(--primary-color);
    }

    .kl-text-error {
        color: #ff3838;
    }

    .kl-dropdown-menu {
        background: var(--ui-bg-color);
    }

    .kl-pinch-overlay {
        background: rgba(0, 0, 0, 0.5);
    }
}