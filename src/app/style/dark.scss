@use 'vars';

:root {
    --ui-bg-dark: #{vars.$dark-surface};
}

body.kl-theme-dark {
    color-scheme: dark;
    color: vars.$dark-on-background;
    background: vars.$dark-background;

    .kl-toolspace {
        background: var(--ui-bg-dark);
    }

    .kl-toolspace--left {
        border-right: 1px solid vars.$dark-outline;
    }

    .kl-toolspace--right {
        border-left: 1px solid vars.$dark-outline;
    }

    .kl-toolspace-row {
        background-color: transparent;
        box-shadow: 0 1px 1px rgba(vars.$dark-on-surface, 0.1);
    }

    .toolspace-row-button-activated {
        background: vars.$dark-primary-container;
    }

    .toolspace-row-button-hover {
        background: rgba(vars.$dark-primary, 0.2);
    }

    .toolspace-row-button:active {
        background: rgba(vars.$dark-primary, 0.3);
    }

    .toolspace-svg-triangle-button-hover {
        fill: rgba(vars.$dark-primary, 0.2);
    }

    .toolspace-svg-triangle-button:active {
        fill: rgba(vars.$dark-primary, 0.3);
    }

    .toolspace-row-button__submit:hover {
        background: vars.$dark-primary;
    }

    .tabrow {
        background-color: vars.$dark-surface-variant;
        border-bottom: 1px solid vars.$dark-outline;
    }

    .tabrow__tab {
        color: vars.$dark-on-surface-variant;
    }

    .tabrow__tab--opened,
    .tabrow__tab--opened-accented {
        background-color: vars.$dark-background;
    }

    .tabrow__tab div {
        filter: invert(1) brightness(0.9);
    }

    .tabrow__tab:not(.tabrow__tab--opened, .tabrow__tab--opened-accented):hover {
        background-color: rgba(vars.$dark-on-surface, 0.1);
    }

    .tabrow__tab:active:not(.tabrow__tab--opened-accented, .tabrow__tab--opened) {
        box-shadow: inset 0 1px rgba(vars.$dark-on-surface, 0.5);
    }

    .tabrow__tab__rounding-left,
    .tabrow__tab__rounding-right {
        background: vars.$dark-background;
    }

    .kl-tool-row-border-right {
        border-right: 1px solid vars.$dark-outline-variant;
    }

    .tool-dropdown-wrapper {
        background-color: vars.$dark-surface-variant;
    }

    .tool-dropdown-button:hover {
        background: color.scale(vars.$dark-surface-variant, $lightness: 10%);
    }

    .tool-dropdown-button:active {
        background: color.scale(vars.$dark-surface-variant, $lightness: 5%);
    }

    .kl-popup {
        background: rgba(vars.$dark-on-surface, 0.5);
    }

    .kl-popup-box {
        background-color: var(--ui-bg-dark);
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    .kl-d-modal-root {
        background: rgba(vars.$dark-on-surface, 0.5);
    }

    .kl-d-modal {
        background-color: var(--ui-bg-dark);
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    button {
        color: vars.$dark-on-surface-variant;
        background-color: vars.$dark-surface-variant;
        border: none;
        box-shadow: none;
        user-select: none;
    }

    button:hover {
        background-color: color.scale(vars.$dark-surface-variant, $lightness: 5%);
        color: vars.$dark-on-surface;
    }

    button:active {
        background-color: color.scale(vars.$dark-surface-variant, $lightness: 8%);
        color: vars.$dark-on-surface;
        box-shadow: 0 0 0 1px rgba(vars.$dark-on-surface, 0.2);
    }

    button:disabled {
        color: rgba(vars.$dark-on-surface, 0.5);
        background-color: transparent;
        box-shadow: 0 0 0 1px rgba(vars.$dark-on-surface, 0.1);
        pointer-events: none;
    }

    .kl-button-primary {
        background: vars.$dark-primary;
        color: vars.$dark-on-primary;

        &:hover {
            background: color.scale(vars.$dark-primary, $lightness: 10%);
        }
    }

    button:not(.kl-button-primary, .kl-button-cancel) img:not(.dark-no-invert) {
        filter: invert(1) hue-rotate(180deg);
    }

    input,
    textarea {
        background: vars.$dark-surface-variant;
        color: vars.$dark-on-surface-variant;
        border: 1px solid vars.$dark-outline;
    }

    input:focus,
    textarea:focus {
        background: vars.$dark-surface;
        color: vars.$dark-on-surface;
        border-color: vars.$dark-primary;
    }

    .kl-select {
        background: vars.$dark-surface-variant;
        color: vars.$dark-on-surface-variant;
        border: 2px solid vars.$dark-outline;
    }

    .kl-checkbox__inner {
        color: vars.$dark-on-surface-variant;

        &:hover {
            color: vars.$dark-on-surface;
        }
    }

    .kl-checkbox--highlight {
        background: none;
        box-shadow: 0 0 0 1px var(--active-highlight-color);
    }

    .kl-option {
        background: var(--ui-bg-dark);
        color: vars.$dark-on-surface;
        box-shadow: inset 0 0 0 1px vars.$dark-outline;

        &:not(.kl-option-selected):hover {
            background: color.scale(vars.$dark-surface, $lightness: 5%);
        }

        &:not(.kl-option-selected):active {
            box-shadow: inset 0 0 0 2px vars.$dark-outline;
        }
    }

    .kl-option-selected {
        background: vars.$dark-primary-container;
        color: vars.$dark-on-primary-container;
        box-shadow: inset 0 0 0 2px var(--active-highlight-color);
    }

    .kl-box-toggle {
        color: vars.$dark-on-surface-variant;
        box-shadow: inset 0 0 0 1px vars.$dark-outline;

        &:not(.kl-box-toggle--active) {
            &:hover {
                background: color.scale(vars.$dark-surface, $lightness: 5%);
            }
            &:active {
                box-shadow: inset 0 0 0 2px vars.$dark-outline;
            }
        }
    }

    .kl-box-toggle--active {
        color: vars.$dark-on-primary-container;
        background: vars.$dark-primary-container;
        box-shadow: inset 0 0 0 2px var(--active-highlight-color);
    }

    .dark-invert {
        filter: invert(1);
    }

    .kl-file-no-autosave {
        background: transparent;
        color: vars.$dark-error;
        box-shadow: inset 0 0 0 1px;
    }

    .slider-wrapper {
        background: vars.$dark-surface-variant;
        box-shadow: 0 0 0 1px vars.$dark-outline;
        color: vars.$dark-on-surface-variant;
        text-shadow: none;

        .slider-inner {
            background: color.scale(vars.$dark-surface-variant, $lightness: 10%);
            box-shadow: 1px 0 0 vars.$dark-outline;
        }
    }

    .slider-wrapper--active {
        box-shadow: 0 0 0 1px vars.$dark-primary;
        color: vars.$dark-on-surface;

        .slider-inner {
            box-shadow: 1px 0 0 vars.$dark-primary;
        }
    }

    .slider-wrapper--disabled {
        box-shadow: none;
        color: rgba(vars.$dark-on-surface-variant, 0.5);
    }

    .info-hint {
        background: none;
        border: 1px solid vars.$dark-error;
        color: vars.$dark-error;
    }

    .kl-2-tabs {
        .kl-2-tabs__left,
        .kl-2-tabs__right {
            border: 1px solid vars.$dark-outline;
            color: vars.$dark-on-surface-variant;
            border-bottom: none;
            &:hover {
                background: vars.$dark-surface-variant;
            }
        }

        .kl-2-tabs__left {
            border-top-left-radius: 10px;
            border-right: none;
        }

        .kl-2-tabs__right {
            border-top-right-radius: 10px;
            border-left: none;
        }

        .kl-2-tabs--active {
            color: vars.$dark-on-primary-container;
            background: vars.$dark-primary-container;
            border: 1px solid var(--active-highlight-color);
            border-bottom: none;

            &:hover {
                background: vars.$dark-primary-container;
            }
        }
    }

    .popup-x {
        filter: invert(1);
    }

    .popup-x:hover {
        filter: invert(1) brightness(1.4);
    }

    .kl-preview-wrapper {
        background: vars.$dark-background;
        box-shadow:
            inset 0 1px vars.$dark-outline,
            inset 0 -1px vars.$dark-outline;

        .kl-preview-wrapper__canvas {
            box-shadow: 0 0 0 1px rgba(vars.$dark-on-surface, 0.25);
        }
    }

    .kl-edit-crop-preview {
        border-top: 1px solid vars.$dark-outline;
        border-bottom: 1px solid vars.$dark-outline;
    }

    .kl-transparent-preview {
        box-shadow:
            inset 0 1px vars.$dark-outline,
            inset 0 -1px vars.$dark-outline;

        .kl-transparent-preview__canvas {
            box-shadow: 0 0 0 1px vars.$dark-outline;
        }
    }

    .kl-merge-preview {
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    a:link,
    a:not([href]),
    a:visited {
        color: vars.$dark-primary;

        &:hover {
            color: color.scale(vars.$dark-primary, $lightness: 15%);
        }
    }

    .kl-color-picker__h,
    .kl-color-picker__sv,
    .kl-color-picker__preview {
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    .kl-color-picker--active {
        box-shadow: 0 0 0 1px vars.$dark-primary;
    }

    .kl-color-picker__secondary {
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    .kl-stabilizer {
        color: vars.$dark-on-surface-variant;
    }

    .brush-alpha,
    .brush-alpha--selected {
        filter: invert(1) hue-rotate(180deg);
    }

    .kl-layer-preview {
        color: vars.$dark-on-surface-variant;
        canvas {
            box-shadow: 0 0 0 1px vars.$dark-outline;
        }
    }

    .kl-import-note,
    .kl-toolspace-note {
        background: none;
        color: vars.$dark-error;
        border: 1px solid vars.$dark-error;
    }

    .kl-curves-graph {
        canvas {
            background: vars.$dark-surface;
            filter: invert(1) hue-rotate(180deg);
        }
    }

    .kl-curves-graph__grip {
        background: vars.$dark-on-surface;
        box-shadow: none;
    }

    .kl-storage-preview {
        background: vars.$dark-background;
        box-shadow: inset 0 0 0 1px vars.$dark-outline;
        color: vars.$dark-on-surface-variant;
    }

    .kl-storage-preview__im {
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    .kl-info-btn {
        box-shadow: inset 0 0 0 1px vars.$dark-on-surface;
    }

    .kl-layer {
        background: transparent;
        border: 1px solid vars.$dark-outline-variant;
        .kl-layer__label,
        .kl-layer__opacity-label {
            color: vars.$dark-on-surface-variant;
        }
    }

    .kl-layer--selected {
        background: vars.$dark-primary-container;
        border: 1px solid var(--active-highlight-color);

        .kl-layer__label {
            color: vars.$dark-on-primary-container;
        }
    }

    .kl-point-slider__line {
        background: vars.$dark-outline;
    }

    .kl-point-slider__point {
        box-shadow: none;
        background-color: vars.$dark-on-surface;
    }

    .kl-overlay-toolspace {
        background: transparent;
        border: none;
        box-shadow: none;
    }

    .kl-overlay-toolspace__color {
        box-shadow: 0 0 0 1px vars.$dark-outline;
    }

    .image-toggle {
        &:not(.image-toggle-active) {
            &:hover {
                background: color.scale(vars.$dark-surface-variant, $lightness: 5%);
            }
            &:active {
                box-shadow: vars.$dark-outline 0 0 0 2px;
            }
        }
    }

    .image-toggle-active {
        background: vars.$dark-primary-container;
    }

    .kl-file-save-wrapper {
        box-shadow: inset 0 0 0 1px rgba(vars.$dark-on-surface, 0.2);
    }

    .grid-hr {
        border-bottom: 1px solid rgba(vars.$dark-on-surface, 0.2);
        border-top: none;
    }

    .kl-color-option {
        box-shadow: 0 0 0 1px vars.$dark-outline;
        &:not(.kl-color-option--active):active {
            box-shadow: 0 0 0 2px vars.$dark-outline;
        }
    }

    .kl-color-option--active {
        box-shadow:
            0 0 0 2px var(--active-highlight-color),
            0 0 5px 0 var(--active-highlight-color);
    }

    .kl-text-error {
        color: vars.$dark-error;
    }

    .kl-dropdown-menu {
        background: var(--ui-bg-dark);
        box-shadow: 0 2px 5px rgba(vars.$dark-background, 0.5);
    }

    .kl-pinch-overlay {
        background: rgba(0, 0, 0, 0.5);
    }
}